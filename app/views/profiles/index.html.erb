
<div class="col-md-offset-5 col-md-5">
    <h1>Profile</h1>
</div>
<br/>
<%= link_to "Add Profile",new_profile_path,  :class=>"btn btn-info" %>

<div class="container">
     <table cellpadding="0" cellspacing="0" border="0" class="display table" width="100%" id="table" data-source="<%= profiles_url(format: "json") %>">
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Phone no</th>
                <th>Photo</th>
                <th>Action</th>
            </tr>
        </thead>
    <tbody>
      
    </tbody>
  </table>
  <br>
  <%= form_tag "/profiles/upload_excel", multipart: true do %>
  <div class=" col-md-2">
      <lable><b>Upload Excel File :</b></lable>
    </div>
    <div class=" col-md-2">
      <%= file_field_tag :file, :required=>true,:onchange=>"ValidateSingleInput(this);" %>
    </div>
    <div class=" col-md-5">
      <%= submit_tag "upload" %>
    </div>
    <div class=" col-md-3">
      <a href = "/xls_uploads/phonebook_excel_format.xlsx" > Download Excel Format</a>
    </div>
    <% end %>
</div>
<br>
  


<script type="text/javascript">
var _validFileExtensions = [".xlsx", ".xlsm", ".xlsb", ".xltx", ".xltm", ".xls", ".xls",".ods", ".csv"];    
function ValidateSingleInput(oInput) {
    if (oInput.type == "file") {
        var sFileName = oInput.value;
         if (sFileName.length > 0) {
            var blnValid = false;
            for (var j = 0; j < _validFileExtensions.length; j++) {
                var sCurExtension = _validFileExtensions[j];
                if (sFileName.substr(sFileName.length - sCurExtension.length, sCurExtension.length).toLowerCase() == sCurExtension.toLowerCase()) {
                    blnValid = true;
                    break;
                }
            }
             
            if (!blnValid) {
                alert("Sorry, " + sFileName + " is invalid, allowed extensions are: " + _validFileExtensions.join(", "));
                oInput.value = "";
                return false;
            }
        }
    }
    return true;
}
</script>

  